version: '3'

services:
  db:
    image: mongo
    ports:
      - 27017:27017

  db-seeds:
    build: ./services/mongo-seeds
    links:
      - db

  curb-gateway:
    build: ./services/gateway
    ports:
      - 4000:4000
    depends_on:
      - curb-accounts
      - curb-users
      - curb-groups
      - curb-contents
      - curb-emailing

  curb-users:
    build:
      context: ./services/users
      dockerfile: Dockerfile.test
    ports:
      - 4003:4000
    depends_on:
      - db

  curb-accounts:
    build:
      context: ./services/accounts
      dockerfile: Dockerfile.test
    ports:
      - 4001:4000
    depends_on:
      - db

  curb-groups:
    build:
      context: ./services/groups
      dockerfile: Dockerfile.test
    ports:
      - 4002:4000
    depends_on:
      - db

  curb-contents:
    build:
      context: ./services/contents
      dockerfile: Dockerfile.test
    ports:
      - 4004:4000
    depends_on:
      - db
  curb-emailing:
    build:
      context: ./services/emailing
      dockerfile: Dockerfile.test
    ports:
      - 4005:4000
    depends_on:
      - db
